This file is used to define **local DNS zones**.

```powershell title="default named.conf.local conf"
//
// Do any local configuration here
//
```

---
## What is configured here

Typically, `named.conf.local` contains:

- `zone` declarations
- Zone type (`master` or `slave`)
- Zone files location
- Zone transfer permissions

---

## Basic zone syntax

```powershell
zone "example.com" {
     type master;
     file "/etc/bind/db.example.com";
};
```

### Meaning

- Declares that this DNS server is responsible for `example.com`
- Defines how the zone is managed and where its data is stored

---

## Zone name

```powershell
zone "example.com"
```

- The **domain name** of the zone
- Must match the SOA record inside the zone file
- For reverse zones, this is written in **in-addr.arpa** format

Example (reverse zone):

```powershell
zone "44.168.192.in-addr.arpa"
```

> Important
> If the network is for example /23, we have to define various reversed zones.
> 192.168.42.0/23
>    - 42.168.192.in-addr.arpa
>    - 43.168.192.in-addr.arpa

---

## `type` — Zone role

### a) `master` (primary)

```powershell
type master;
```

- This server is the **authoritative source** of the zone
- Zone data is stored locally in a file
- Other servers (slaves) copy data from it

Use when:

- Creating the main DNS server for a domain

---

### b) `slave` (secondary)

```powershell
type slave;
```

- Zone data is **copied from a master**
- Zone file is auto-generated by BIND
- Cannot be edited manually

Use when:

- Creating redundancy / failover DNS

---

### c) `forward`

```powershell
type forward;
```

- Queries for this zone are forwarded to another DNS server
- No local zone file

Example:

```powershell
type forward; forwarders { 192.168.44.10; };
```

Use when:

- Delegating resolution to another DNS server

---

### d) `hint` (rare)

```powershell
type hint;
```

- Used for root servers
- Defined only once (root zone)
- Almost never modified

---

## `file` — Zone database file

```powershell
file "/etc/bind/db.example.com";
```

- Location of the zone data
- Required for `master` and `slave`
- For `slave`, usually stored in `/var/cache/bind/`

Example (slave):

`file "/var/cache/bind/db.example.com";`

---

## `masters` — Where slaves get data from

Used **only in slave zones**.

```powershell
masters { 192.168.44.4; };
```

- IP address of the primary DNS
- Can list multiple masters (fallback)

---

## `allow-transfer` — Zone transfers

```powershell
allow-transfer { 192.168.44.5; };
```

- Defines which servers may perform AXFR/IXFR
- **Critical for security**
- Never use `any;` in production

Used mainly on **master** zones.

---

## `notify` — Notify slaves of changes

```powershell
notify yes;
```

- Master notifies slaves when zone changes
- Slaves update immediately
- Default: `yes` for master zones

---

## `also-notify`

```powershell
also-notify { 192.168.44.5; };
```

- Additional servers to notify
- Useful when multiple slaves exist

---

## `allow-query` — Who can query this zone

```powershell
allow-query { 192.168.44.0/23; };
```

- Restricts access **per zone**
- Overrides global `allow-query`

---

## `update-policy` — Dynamic DNS (DDNS)

```powershell
update-policy local;
```

or

```powershell
update-policy {
	grant dhcp-key zonesub ANY; 
};
```

- Allows dynamic updates (usually from DHCP)
- Used in DNS + DHCP integration
- Requires TSIG keys

---

## `check-names`

```powershell
check-names master warn;
```

- Controls hostname validation
- Useful for compatibility with old systems

---

## `auto-dnssec` (advanced)

```powershell
auto-dnssec maintain;
```

- Enables automatic DNSSEC signing
- Advanced / production setups

---

## Example: Full master zone definition

```powershell
zone "zalduabat.eus" {
     type master;
     file "/etc/bind/db.zalduabat.eus";
     allow-transfer { 192.168.44.5; };
     notify yes;
};
```

---

## Example: Full slave zone definition

```powershell
zone "zalduabat.eus" {
	type slave;
	file "/var/cache/bind/db.zalduabat.eus";
	masters { 192.168.44.4; };
};
```

---

## Exam summary (very important)

- `master` → original zone data
- `slave` → copies zone from master
- `file` → zone database location
- `masters` → where slaves pull data from
- `allow-transfer` → security
- `named.conf.local` → zones ONLY